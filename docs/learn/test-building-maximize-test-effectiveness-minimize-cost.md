

[![feedback](https://www.visualstudio.com/wp-content/uploads/2017/01/feedback-button-normal.svg)](#)













[![](https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31)
Microsoft](https://www.microsoft.com)



Visual
Studio



  - [Microsoft 365](https://www.microsoft.com/en-us/microsoft-365)

  - [Azure](https://azure.microsoft.com)

  - [Office 365](https://products.office.com/en-us/business/office)

  - [Dynamics 365](https://dynamics.microsoft.com/en-us/)

  - [SQL](https://www.microsoft.com/sql-server/)

  - [Windows 10](https://www.microsoft.com/en-us/windowsforbusiness)

  - 
    
    
    
    More
    
      - Products & Services
          - [Windows
            Server](https://www.microsoft.com/cloud-platform/windows-server)
          - [Enterprise Mobility +
            Security](https://www.microsoft.com/cloud-platform/enterprise-mobility-security)
          - [Power
            BI](https://powerbi.microsoft.com/en-us/)
          - [Teams](https://products.office.com/en-us/microsoft-teams/group-chat-software)
          - [Visual Studio](https://www.visualstudio.com/)
          - [Surface for
            Business](https://www.microsoft.com/en-us/surface/business/overview)
      - Emerging Technologies
          - [AI](https://www.microsoft.com/ai/)
          - [Internet of
            Things](https://www.microsoft.com/internet-of-things)
          - [Azure Cognitive
            Services](https://azure.microsoft.com/services/cognitive-services/)
          - [Quantum](https://www.microsoft.com/quantum/)
          - [Research](https://www.microsoft.com/research/)
      - Developer & IT
          - [Docs](https://docs.microsoft.com/en-us/)
          - [TechNet](https://technet.microsoft.com/en-us/ms376608.aspx)
          - [Developer Network](https://msdn.microsoft.com/en-us)
          - [Windows Dev
            Center](https://developer.microsoft.com/en-us/windows)
          - [Windows IT Pro
            Center](https://www.microsoft.com/en-us/itpro/windows)
          - [FastTrack](https://fasttrack.microsoft.com/office)
      - Partner
          - [Partner Network](https://partner.microsoft.com/)
          - [Solution
            Providers](https://www.microsoft.com/solution-providers/)
          - [Partner
            Center](https://partnercenter.microsoft.com/partner/home)
          - [Cloud
            Hosting](https://www.microsoft.com/en-us/cloudandhosting)
      - Industries
          - [Education](https://www.microsoft.com/en-us/education)
          - [Financial
            services](https://enterprise.microsoft.com/en-us)
          - [Government](https://enterprise.microsoft.com/en-us/industries/government/)
          - [Health](https://enterprise.microsoft.com/en-us/industries/health/)
          - [Manufacturing &
            resources](https://enterprise.microsoft.com/en-us/industries/discrete-manufacturing/)
          - [Retail](https://enterprise.microsoft.com/en-us/industries/retail-and-consumer-goods/)
      - Other
          - [Security](https://www.microsoft.com/security/)
          - [Licensing](https://www.microsoft.com/licensing/)
          - [AppSource](https://appsource.microsoft.com/)
          - [Azure
            Marketplace](https://azuremarketplace.microsoft.com/marketplace/)
          - [Events](https://events.microsoft.com/)
      - [View
all](https://www.microsoft.com/en-us/sitemap.aspx)
    
    













Sign
in

















[Visual Studio](https://www.visualstudio.com/) [Free
Account](https://go.microsoft.com/fwlink/?LinkId=307137&clcid=0x409&wt.mc_id=o~msft~vscom~product-vsts-nav~menu&campaign=o~msft~vscom~product-vsts-nav~menu)

[Visual Studio Team
Services](https://www.visualstudio.com/team-services/)



Features

  - [Git](https://www.visualstudio.com/team-services/git/)
  - [TFVC](https://www.visualstudio.com/team-services/tfvc/)
  - [Agile
    Tools](https://www.visualstudio.com/team-services/agile-tools/)
  - [CI/CD](https://www.visualstudio.com/team-services/continuous-integration/)
  - [All Features](https://www.visualstudio.com/team-services/features/)





Pricing

  - [VSTS](https://www.visualstudio.com/team-services/pricing/)
  - [TFS](https://www.visualstudio.com/team-services/tfs-pricing/)
  - [Feature
    Comparisons](https://www.visualstudio.com/team-services/compare-features/)





News

  - [Release
    Notes](https://www.visualstudio.com/team-services/release-notes/)
  - [Microsoft DevOps Blog](https://blogs.msdn.microsoft.com/devops/)
  - [VSTS Customer
    Stories](https://www.visualstudio.com/team-services/case-studies/)





Support

  - [VSTS](https://www.visualstudio.com/team-services/support/)
  - [Team Foundation
    Server](https://www.visualstudio.com/team-services/tfs_support/)
  - [Documentation](https://docs.microsoft.com/en-us/vsts/index)
  - [FAQ](https://www.visualstudio.com/team-services/faq/)



[Subscriber
Access](https://my.visualstudio.com/Benefits?wt.mc_id=o~msft~vscom~nav&campaign=o~msft~vscom~nav)
[Free
Account](https://go.microsoft.com/fwlink/?LinkId=307137&clcid=0x409&wt.mc_id=o~msft~vscom~product-vsts-nav~menu&campaign=o~msft~vscom~product-vsts-nav~menu)

































[Home](https://www.visualstudio.com)/Test
while building to maximize test effectiveness and minimize
cost



















# Test while building to maximize test effectiveness and minimize cost

### By Jacek Czerwonka



#### About the author





[Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.visualstudio.com%2Flearn%2Ftest-building-maximize-test-effectiveness-minimize-cost%2F&t=Test%20while%20building%20to%20maximize%20test%20effectiveness%20and%20minimize%20cost "Facebook")[Twitter](https://twitter.com/share?text=Test%20while%20building%20to%20maximize%20test%20effectiveness%20and%20minimize%20cost&url=https%3A%2F%2Fwww.visualstudio.com%2Flearn%2Ftest-building-maximize-test-effectiveness-minimize-cost%2F "Twitter")[Linkedin](https://www.linkedin.com/shareArticle?mini=true&url=https://www.visualstudio.com/learn/test-building-maximize-test-effectiveness-minimize-cost/&title=Test%20while%20building%20to%20maximize%20test%20effectiveness%20and%20minimize%20cost&summary=Test%20while%20building%20to%20maximize%20test%20effectiveness%20and%20minimize%20cost%0D%0AAuthor%3A%20Jacek%20Czerwonka%0D%0ALast%20Update%3A%209%2F27%2F2016%0D%0A%0D%0AUnit%20testing%20is%20a%20commonly%20used%20practice%20for%20early%20detection%20of%20defects%20in%20software.%20One%20of%20its%20applications%20is%20regression%20testing%2C%20whi "Linkedin")[Email](mailto:?subject=Test%20while%20building%20to%20maximize%20test%20effectiveness%20and%20minimize%20cost&body=https://www.visualstudio.com/learn/test-building-maximize-test-effectiveness-minimize-cost/ "Email")



















# Test while building to maximize test effectiveness and minimize cost

### Author: Jacek Czerwonka

Last Update: 9/27/2016

Unit testing is a commonly used practice for early detection of defects
in software. One of its applications is regression testing, which
ensures that software changes do not break any of the previously working
functionality.

## Mapping tests to code is believed to reduce cost

Although the main benefits of regression testing in managing risk of
software releases are well known, one of the common issues is the cost
of executing regression tests. In recent academic studies \[1, 2, 3\],
regression testing is found to take up to 80% of the testing budget.
Many ways were proposed to tackle this problem; just look up “regression
test selection” in literature. The way these methods typically work is
that they attempt to establish a mapping between product code and test
cases, and when the product changes, the mapping identifies affected
tests. Although you can find many types of test selection techniques
\[4\], they are not widely adopted in practice due to a significant
overhead in terms of collecting and maintaining dependency information.

## Mapping software to its tests – the old way

In the simplest case, teams define and maintain the mapping manually.
Even if initially accurate (unlikely), it quickly becomes a maintenance
headache on its own. Some level of systematic data collection is needed
to keep the map up to date. Collecting code coverage information is one
such mechanism. It comes with many benefits: it typically is collected
at a level that enables fine granularity of the mapping (for example,
the method to test or even a statement to test). But coverage is also
expensive to collect regularly and is always a bit behind, because
collecting coverage depends on running tests.

## Use the build to find the right set of unit tests

We experimented with another approach. One that assumes that the mapping
should be a by-product of software construction so it is always up to
date and available. Once available, the system executes only a subset of
unit tests impacted by a change with no additional overhead beyond what
is required by the underlying build system.

## Fitting a DevOps Delivery Cadence

Microsoft has rapidly adopted agile software engineering methodology to
enable a delivery cadence of days or weeks. For instance, Office 365,
Visual Studio Team Services, and SQL Azure have release cycles measured
in weeks. Others might even release several times daily.

## Enter CloudBuild for fast feedback

Thousands of Microsoft engineers build and test hundreds of software
products many times a day. It is essential that this continuous
integration scales, guarantees short feedback cycles, and functions
reliably with minimal human intervention. Our cloud-based build system
(appropriately called CloudBuild) is responsible for all aspects of a
continuous integration workflow, including builds, tests, code analysis,
deliverying build outputs, and creating and storing packages. CloudBuild
uses content-based caching to run tasks only when needed. Also,
CloudBuild uses many machines in parallel.

## Mapping software to its tests – now by construction

When your build, testing, and program analysis pipeline is distributed,
the pipeline provides fast, reliable, resource-effective, and convenient
builds through incremental, cached, and scaled-out computations. In
particular, CloudBuild does static parsing of build metadata in the
source code and generates a dependency graph for all projects. Next,
CloudBuild builds only those projects that are impacted by a given code
change. Therefore, if a test project is not built fresh by CloudBuild,
it is not going to be executed. The effect is that CloudBuild performs
regression test selection as a side-effect of its regular function.

![Build and test dependencies with associated build
actions](https://www.visualstudio.com/wp-content/uploads/2017/08/build-test-dependencies.png)

## Testing earlier, while building

Traditionally, tests are executed only after the entire build is
completed. In contrast, CloudBuild executes tests immediately after the
referenced projects are compiled, rather than waiting for the entire
build to finish. Since builds and tests are automatically distributed
across multiple machines in data centers, CloudBuild efficiently
executes tests without adding any substantial overhead to the overall
build time. In this way, tens of millions of tests, contributed by
thousands of Microsoft engineers, are automatically run every day.

## Only good tests apply

The goal is to provide fast, reliable, and isolated test executions.
Since builders in data centers are shared across projects, it is
important to ensure that test executions of one do not pollute the state
of another (or the build nodes themselves). Only tests that meet the
“5S” criteria are allowed to run as part of the build. The tests
should be:

  - Significant – you’re willing to break the build when they fail.
  - Short – they execute in seconds. Tests whose duration is too
    variable or sensitive to timing are not good candidates.
  - Simple – they run on a single node and do not require complex
    topologies.
  - Standalone – they bring all required dependencies and data with
    them, so that they don’t require set up.
  - (Without) Side-effects – they do not change system-wide state
    before, during, or after they run.

## Enforcing test quality

To ensure no content is authored that breaks the above rules, we have to
very powerful enforcement mechanisms: (1) any test break is also a build
break; no exceptions, (2) tests execute inside a sandbox that imposes
isolation and timing rules on execution.

By adhering to these principles, CloudBuild infrastructure provides
enough rigor to allow tests to run as part of a build in a data center
and not pollute the environment while still providing engineers enough
functionality out of the box. And, as a bonus, we run only those tests
that are affected by changes.

## References

\[1\] E. Engstrom and P. Runeson. A qualitative survey of regression
testing practices. In Product-Focused Software Process Improvement,
volume 6156, pages 3-16. Springer-Verlag, 2010

\[2\] H. K. N. Leung and L. White. Insights into regression testing. In
International Conference on Software Maintenance, pages 60-69, 1989.

\[3\] P. K. Chittimalli and M. J. Harrold. Re-computing coverage
information to assist regression testing. In International Conference on
Software Maintenance, pages 164-173, 2007.

\[4\] S. Yoo and M. Harman. Regression testing minimization, selection
and prioritization: A survey. Journal of Software Testing, Verification
and Reliability, 22(2):67-120, 2012.



  [Jacek
Czerwonka](https://www.visualstudio.com/author/jacekcz/ "Posts by Jacek Czerwonka")
  
2017-08-14T15:33:35+00:00 







![Jacek
Czerwonka](https://www.visualstudio.com/wp-content/uploads/2017/08/jacekcz_avatar_1502749714.png)





### Jacek Czerwonka

Jacek is a lead developer on the Tools for Software Engineers team
focusing creating solutions for understanding software engineering
organizations, and improving engineering processes at Microsoft. His
team works on engineering data analytics platform CodeMine and code
review experiences and tools.















  - [DevOps at
    Microsoft](https://www.visualstudio.com/learn/devops-at-microsoft/)
  - [How We Work with Visual Studio Team
    Services (VSTS)](#)
      - [Moving to Cloud
        Cadence](https://www.visualstudio.com/learn/moving-cloud-cadence/)
      - [How We Use Git at
        Microsoft](https://www.visualstudio.com/learn/use-git-microsoft/)
      - [Evolving Test Practices at
        Microsoft](https://www.visualstudio.com/learn/evolving-test-practices-microsoft/)
  - [How We Architect Visual Studio Team
    Services (VSTS)](#)
      - [From Monolith to Cloud
        Service](https://www.visualstudio.com/learn/monolith-cloud-service/)
      - [Achieving No Downtime Through
        Versioned Service
        Updates](https://www.visualstudio.com/learn/achieving-no-downtime-versioned-service-updates/)
      - [Progressive Experimentation with
        Feature
        Flags](https://www.visualstudio.com/learn/progressive-experimentation-feature-flags/)
      - [Patterns for Resiliency in the
        Cloud](https://www.visualstudio.com/learn/patterns-resiliency-cloud/)
      - [Shift Left to Make Testing Fast and
        Reliable](https://www.visualstudio.com/learn/shift-left-make-testing-fast-reliable/)
      - [Eliminating Flaky
        Tests](https://www.visualstudio.com/learn/eliminating-flaky-tests/)
      - [Shift Right to Test in
        Production](https://www.visualstudio.com/learn/shift-right-test-production/)
  - [One Engineering System at
    Microsoft](#)
      - [Moving 65,000 Microsofties to DevOps
        on the Public
        Cloud](https://www.visualstudio.com/learn/moving-65000-microsofties-devops-public-cloud/)
      - [Universal Store: Journey to
        Continuous Delivery and
        DevOps](https://www.visualstudio.com/learn/universal-store-journey-continuous-delivery-devops/)
  - [Microsoft Research on DevOps
    Productivity](#)
      - [Boosting your code reviews with
        useful
        comments](https://www.visualstudio.com/learn/boosting-code-reviews-useful-comments/)
      - [Code reviews are not (primarily) for
        finding
        bugs](https://www.visualstudio.com/learn/code-reviews-not-primarily-finding-bugs/)
      - [Code ownership and software
        quality](https://www.visualstudio.com/learn/code-ownership-software-quality/)
      - [Getting the noise out of test
        runs](https://www.visualstudio.com/learn/getting-noise-test-runs/)
      - [Improving software security with
        stack traces from bug
        reports](https://www.visualstudio.com/learn/improving-software-security-stack-traces-bug-reports/)
      - [Is 100% code coverage worth the
        cost?](https://www.visualstudio.com/learn/100-code-coverage-worth-cost/)
      - [Software testing at scale to
        increase
        velocity](https://www.visualstudio.com/learn/software-testing-scale-increase-velocity/)
      - [Test while building to maximize test
        effectiveness and minimize
        cost](https://www.visualstudio.com/learn/test-building-maximize-test-effectiveness-minimize-cost/)
      - [Using a simple code churn metric to
        find software
        bugs](https://www.visualstudio.com/learn/using-simple-code-churn-metric-find-software-bugs/)



















  - [** DevOps at Microsoft](/learn/devops-at-microsoft/)
  - [** Blog](https://blogs.msdn.microsoft.com/devops/)
  - [** Learn DevOps](/learn/what-is-devops/)
  - [![](/wp-content/uploads/2016/11/git-footer-icons-dark_2.png) Learn
    Git](/learn-git/)
  - [** Learn Agile](/agile/)
  - [** DevOps Self-Assessment](https://devopsassessment.net/)













[Visual Studio Team Services](/team-services/) provides the tools you
need to continuously deliver
value





















#### What's new

  - [Surface
    Book 2](https://www.microsoft.com/en-us/surface/devices/surface-book-2/overview)
  - [Surface
    Pro](https://www.microsoft.com/en-us/surface/devices/surface-pro/overview)
  - [Xbox One X](https://www.xbox.com/en-us/xbox-one-x)
  - [Xbox One S](https://www.xbox.com/en-us/xbox-one-s?xr=shellnav)
  - [VR & mixed
    reality](https://www.microsoft.com/en-us/store/b/virtualreality)
  - [Windows 10
    apps](https://www.microsoft.com/en-us/windows/windows-10-apps)
  - [Office
apps](https://store.office.com/en-us/appshome.aspx?)





#### Store & Support

  - [Account profile](https://account.microsoft.com/)
  - [Download Center](https://www.microsoft.com/en-us/download)
  - [Sales &
    support](https://go.microsoft.com/fwlink/p/?LinkID=824761&clcid=0x409)
  - [Returns](https://go.microsoft.com/fwlink/p/?LinkID=824764&clcid=0x409)
  - [Order tracking](https://account.microsoft.com/orders)
  - [Store
    locations](https://www.microsoft.com/en-us/store/locations/find-a-store)
  - [Support](https://support.microsoft.com/en-us)
  - [Buy online, pick up in
    store](https://www.microsoft.com/en-us/store/b/buy-online-pick-up-in-store?icid=uhf_footer_bopuis)





#### Education

  - [Microsoft in education](https://www.microsoft.com/en-us/education)
  - [Office for
    students](https://www.microsoft.com/en-us/education/products/office/default.aspx)
  - [Office 365 for
    schools](https://products.office.com/en-us/academic/compare-office-365-education-plans)
  - [Deals for students &
    educators](https://www.microsoft.com/en-us/store/b/student)
  - [Microsoft Azure in
    education](https://azure.microsoft.com/en-us/community/education/)









#### Enterprise

  - [Microsoft Azure](https://azure.microsoft.com/)
  - [Enterprise](https://enterprise.microsoft.com/en-us/)
  - [Data platform](https://www.microsoft.com/en-us/sql-server/)
  - [Find a solutions
    provider](https://www.microsoft.com/en-us/solution-providers)
  - [Microsoft partner resources](https://partner.microsoft.com/en-us/)
  - [Microsoft
    AppSource](https://go.microsoft.com/fwlink/?LinkID=808093)
  - [Manufacturing &
    resources](https://enterprise.microsoft.com/en-us/industries/discrete-manufacturing/)
  - [Financial
services](https://enterprise.microsoft.com/en-us)





#### Developer

  - [Microsoft Visual Studio](https://www.visualstudio.com/)
  - [Windows Dev Center](https://developer.microsoft.com/en-us/windows)
  - [Developer Network](https://msdn.microsoft.com/en-us)
  - [TechNet](https://technet.microsoft.com/en-us)
  - [Microsoft Virtual Academy](https://mva.microsoft.com/)
  - [Microsoft developer
    program](https://developer.microsoft.com/en-us/store/register)
  - [Channel 9](https://channel9.msdn.com/)
  - [Office Dev
Center](https://developer.microsoft.com/en-us/office)





#### Company

  - [Careers](https://careers.microsoft.com/)
  - [About Microsoft](https://www.microsoft.com/en-us/about)
  - [Company news](https://news.microsoft.com/)
  - [Privacy at Microsoft](https://privacy.microsoft.com/en-us)
  - [Investors](https://www.microsoft.com/investor/default.aspx)
  - [Diversity and
    inclusion](https://www.microsoft.com/en-us/diversity/)
  - [Accessibility](https://www.microsoft.com/en-us/accessibility/home)
  - [Security](https://www.microsoft.com/en-us/security/default.aspx)







[English (United States)](#)

  - [Contact us](https://beta.visualstudio.com/support/)
  - [Privacy &
    cookies](https://www.microsoft.com/EN-US/privacystatement/OnlineServices/Default.aspx)
  - [Terms of use](https://azure.microsoft.com/en-us/support/legal/)
  - [Trademarks](https://www.microsoft.com/trademarks)
  - [About our ads](http://choice.microsoft.com/)
  - © Microsoft 2018












